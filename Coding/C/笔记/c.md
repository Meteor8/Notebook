# C学习笔记

## 学习情况

入门。在单片机编程中使用，但高级语法使用少、了解少。

## 基础语法

### 变量命名

变量首位必须是“字母”或“下划线”

### 头文件

| 内置函数 | 所属头文件 |
| :------: | :--------: |
|  printf  | <stdio.h>  |
|  scanf   |            |
| getchar  |            |
| putchar  |            |
|   time   |  <time.h>  |
|  strcpy  | <string.h> |
|  strcmp  |            |

### 类型

#### 常量

`const`常量所有字母要大写，不能改编

#### 浮点型

浮点型赋值时，数字一般后加上f

如：`float a = 2f`

浮点型占位符

如：`%2f` 精确度为小数点后两位

#### 静态变量

`static int a = 0; //只执行一次`

基本类型的静态变量系统默认赋初值为0
静态变量的生存期为整个源程序，作用域只是定义它的文件

#### 字符串

字符串是以字符数组来表示，一定以”\0”结尾

#### 其他

| 存储类型说明符 |  存储类型  |                             说明                             |
| :------------: | :--------: | :----------------------------------------------------------: |
|      auto      |  自动存储  | 只能用于块作用域的变量声明中，局部变量默认情况下归为自动存储类型 |
|    register    | 寄存器存储 | 只用于块作用域的变量，请求速度快。对于循环次数较多的循环控制变量及循环体内反复使用的变量均可定义为寄存器变量 |
|     static     |  静态存储  |            载入程序时创建对象，程序结束时对象消失            |
|     extern     |  外部变量  |                  期贯穿应用程序的开始和结束                  |

### 数组

#### 一维数组

`int nums[size] = {1,2,3,4,5,...}`

#### 二维数组

`int nums[3][2]={{1,3},{2,4},{1,5}};`

#### char型数组

```c
char name[8];//用来存放用户输入的姓名
//姓名数组，最多容纳6个字符串，每个字符串的最大长度为8个字符（英文
char names[6][8]= {"西施"."貂蝉"，"王昭君"."杨玉环"."赵飞燕"};
//级别数组，最多容纳5个字符串，每个字符串的最大长度为8个字符（英文
char levelNames[5][8]=f"贵人"，"嫔妃"."贵妃"，"皇贵妃"，"皇后"};
//用来存放每个妃子的等级，与levelNames联用。-1表示未启用
int level[= {o.0,0,o,o，-1};
//用来存放每个妃子的好感度，-1表示未启用
int loves[]= {100,100,100,100,100,-1};
```

#### 数组名

数组名就是这块连续内存单元的首地址
`int num[50]; //num是数组名，也是数组的首地址`
`num`的值与`&num[0]`的值是相同的
数组第i+1个元素可表示为:
第i+1个元素的地址: `&num[i+1]`或`num+i+1`
第i+1个元素的值:` num[i +1]`或`*(num +i+1)`
为指向数组的指针赋值∶
`int * ptr_num = num;`或` int * ptr_num = &num[O];`
指针变量可以指向数组元素
`int * ptr_num = &num[4];`或`int * ptr_num = num + 4;`

#### 二维数组与指针

```c
int i，j;
double score[5][3] = {
    {55，66，77}，
    {52，62，72},
    {15，26，37},
    {54, 65，76},
    {55, 66，77}，
};
double (*ptr_score)[3]= score;
for(i = o; i< s; i++){
	for(j = 0; j<3; j++){
		//printf("%.2lf\t", score[i][j]);
        //score[i] => *(score[i]+i);
		printf("%.2lf\t"，*(score[i] +j));
    }
}

```

#### 数组的地址

数组的地址是连续的，

a + 1 会隐式的转换成 a + 1 * sizeof( int ) 【 int的实际上是+4】

所以如果是double 的数组 就实际上+8了

a+1就是将a的值（地址）加上单个数组元素个长度（在这里是一个Int的长度）

### 指针

指针是一个值为内存地址的**变量 （**或数据对象**）**

#### 基本用法

`数据类型 * 指针变量名：`

```c
int * ptr_num;
char * ptr_name;
float * money_ptr;
double * p_price;
```

#### 取地址 、取地址对应的值

|     取地址     |  &   |      ……的地址      |
| :------------: | :--: | :----------------: |
| 取地址对应的值 |  *   | ……所取地址对应的值 |

`*ptr_a` 相当于 `a`	
`&a` 相当于 `ptr_a`

例如：

```
int a=l;
int * ptr_a= &a;
printf("%d\t%p\t%x\td\t%p\t%x\n",a,a,a,&a,&a,&a);
printf ("%d\t%p\t%x\td\t%p\t%x\t",ptr_a,ptr_a,ptr_a,*ptr_a, *ptr_a,*ptr_a);
```

![pointer](res\pointer.png)

```c
//*0060FF08---》1
//ptr_a是一个指针变量（指向a），其值为a的地址，该地址的值（即a的值）为1
```

### 结构体

结构是一种**构造数据类型（自己定义的）**，由若干数据项组合而成

#### 1>声明结构体类型

```c
struct ABC{
	int a;
	char b;
};
```

#### 2>结构体类型定义变量

```c
struct ABC alpha; //(“struct ABC”为一个整体，就是定义的类型名称)
```

#### 3>变量赋值（同时赋值={,,}）

```c
alpha.a=1;
alpha.b='A';
```

#### 注意

1、结构定义并不预留内存
2、结构定义一般放在程序的开始部分（头文件声明之后）
3、结构定义仅用来描述结构的形式，使用结构需要声明结构变量

#### 声明结构同时定义

前者结构名为Hero,后者无结构名，变量名为jackichan...

```c
#include <stdio.h>
struct Hero{
    char* name;
    int level;
    char * job;
    char * skill;
}jackieChan, laola, guofurong;
```

```c
#include <stdio.h>
//直接声明结构变量
struct{
    char * name;
    int level;
    char * job;
    char * skill;
}jackieChan, laola,guofurong;
```

#### **指向结构**的指针——**结构指针**

```c
struct Hero laola =
	{"劳拉"，28,{1988,5.4}."考古学家"，"洛阳铲"};
struct Hero *ptr_laola;
ptr_laola = laola;
printf(职业:%s\n".(*ptr_laola).job);
printf(职业∶%s\n", ptr_laola->job);
```

#### 动态录入结构元素

**动态**录入结构元素中的指针（注意：非结构指针）时，由于没有内存需要分配内存

```c
type struct abc{
	char *name
}
//...
abc.name = (char*) malloc (50)
```

#### typedef

可以为某一类型自定义名称

`typedef unsigend char Byte;`
`Byte btValue1;`

```c
typedef struct [hero]{
    char * name;
    int age;
    char * job;
    char * skill;
}Hero;
//使用∶
Hero hero = f""佟湘玉"，35,"掌柜的""."额滴神呐"};
```

注意:
typedef并没有创造任何新类型，只是为某个已存在的类型增加一个方筷使用的标签

```c
//宏定义（类似define，将整个结构体用Hero表示；_表示临时变量，无用）
typedef strcut _hero{
}Hero;
//...........
Hero hero1;
```

#### 结构数组

元素为结构类型的数组称为结构数组

```c
struct Role{
    char * name;
    int age;
    char* job;
    char* skill;
}roles[25];
struct Role roles [25];
```

```c
struct Role{
    char * name;
    int age;
    char* job;
    char * skill;
}roles[]= {
    {"郭芙蓉"，29，"打杂的"，"排山倒海"},
    {"吕秀才"，30，"账房"，"子曾经曰过""}
};
```

#### 结构作为函数参数的三种方式

##### 1、传递结构成员

##### 2、传递结构

优点∶函数处理的是原始数据的副本，保护了原始数据
缺点∶老版本不支持﹔传递结构浪费时间和存储空间
一般用来处理小型结构数据

##### 3、传递结构的地址

优点︰程序的执行速度快，效率高
缺点∶无法保护数据，函数中的操作有可能会意外影响原结构中的数据
为了追求效率，常用此方案

### 转义序列

| 转义序列 |   名称   |                 描述                 |
| :------: | :------: | :----------------------------------: |
|    \a    | 蜂鸣警报 |       在一些系统中警报不起作用       |
|    \b    |   退格   |            将光标回退--格            |
|    \f    |   换页   |       将光标移到下一页的开始处       |
|    \n    |   换行   |       将光标移到下一行的开始处       |
|    \r    |   回车   |       将光标移到当前行的开始出       |
|    \t    | 水平制表 |     将光标移到下一个水平制表位置     |
|    \v    | 垂直制表 |     将光标移到下一个垂直制表位置     |
|    \'    |  单引号  |  用于打印单引号、双引号、问号、反斜  |
|    \”    |  双引号  |  线等字符(由于这些字符用于定义字符   |
|    \?    |   问号   | 常量，是printf函数的一部分，若直接使 |
|    \I    |  反斜线  |            用会造成混乱)             |

### 字符输出

```c
printf(“%-8.2f”,n);

//“-”左对齐，不带的话右对齐
//“8”占b个字节，
//“2”保留2位小数
```

`printf()` 函数是一个很呆板的函数，%d 如果接收 double 类型的数据，就只显示 0

```c
int a=5,b=2;
double c;
C=a/b; printf(C)=2.0000; 
/*对于C语言中的运算，不同精度的数字参与运算结果的精度取精度最高的参与运算的数字的精度。*/
C=(float)a/b=2.50000/*强制类型转换*/
```

### 字符读取

`scanf(%d,&s);`有返回值，若输入为正整数则为1，否则为0;

1)返回成功读入的数据的项数

2)读入数据时遇到了“文件结束”则返回[EOF]

#### getchar()

getch比getchar少输入回车，直接进行下

getchar读取每个字符，包括空格、制表符、换行符

读%c:时scanf会跳过空格、制表符、换行符【%c不会跳过】

#### 读取char型，只读一位

`scanf("%c%c",&c , &d);`
输入：`12`
`c=‘1’ `
`d=‘2’`

#### 连续输入

##### 方法一

```c
scanf("%d%d",&a,&b);
printf("%d\t%d",a,b);
//输入：1(空格)2
//输出：1(\t)2
```

##### 方法二

```c
scanf("%c%c",&c,&d);
printf("%c\t%c",c,d);
//输入：cd
//输出：c(\t)d
//输入：a(空格)b
//输出：a
```

##### 方法三

```c
char g[6];
scanf("%s",g);
printf("%s",g);
//输入：123(空格)21
//输出：123
//不能输入空格，否则终止
```

##### 方法四

```c
char a[];
gets(a);	/*=scanf(“%d”,a)*/
puts(a);	/*=printf(“%d”,a)*//*尾部自动换行*/
//gets容易越界出bug,可用fgets(a,20,stdin)
//最多输入20-1个字符，从stdin标准输入流中读取
```

##### 方法五

```c
char *name; 
name=”hahha”;
//char name[];
//name=”haha”;	//错误！！！
char name[]=”haha”;	//正确
```

#### 格式

```c
scanf("%dd%d",&a,&b);
printf("%d\t%d",a,b);
//输入：12d21
//输出：12(\t)21
//读入一个d并舍掉
```

#### 循环录入

`while(scanf()==1); `

#### 缓冲区

输入有缓冲区
键入文字暂存在缓存区，键入enter后，程序才可使用用户输入的字符
用一次getchar，就从缓冲区中读取一个字符

### sizeof()/strlen()

```c
char *str1 = "asdfgh";
char str2[] = "asdfgh";
char str3[8] = {'a', 's', 'd'};
char str4[] = "as\0df";
char str5[] = {'a', 's'};
```

```
sizeof(str1) = 4;  strlen(str1) = 6;
sizeof(str2) = 7;  strlen(str2) = 6;
sizeof(str3) = 8;  strlen(str3) = 3;
sizeof(str4) = 6;  strlen(str4) = 2;
sizeof(str5) = 2;  strlen(str5) = 3;
```

str1是字符指针变量，sizeof获得的是该指针所占的地址空间，32位操作系统对应4字节，所以结果是4；strlen返回的是该字符串的长度，遇到'\0'结束，'\0'本身不计算在内，故结果是6。

str2是字符数组，大小由字符串常量"asdfgh"确定，sizeof获得该数组所占内存空间大小，包括字符串结尾的'\0'，所以结果为7；strlen同理返回6。

str3也是字符数组，但大小确定为8，故sizeof得到的结果是8；strlen统计'\0'之前所有字符的个数，即为3；

str4是常量字符数组，sizeof得到字符总数即6；strlen计算至'\0'结束，因此返回2；

总结一句就是sizeof计算的是变量的大小，而strlen计算的是字符串的长度，前者不受字符'\0'影响，后者以'\0'作为长

sizeof(数组名)/sizeof(成员或成员变量的类型)可以得出数组元素的个数

```c
char a[3]={'a', 'b'};
char b[]="china" ;
printf("%d\t%d\t%d\n",sizeof(a),sizeof(a)/sizeof(int),strlen(a));
printf("%d\t%d\t%d",sizeof(b),sizeof(b)/sizeof(char),strlen(b));
//3   0   2
//6   6   5
```



### 注释

`\`		单行注释

`/* */`		多行注释

### 运算符号

#### =赋值

等号右边运算完再赋值

如`int a=2>0`

则`a=1`

#### 取模

5%3=2		5%-3=2		-5%3=-2		-5%-3=-2

取模时的符号与被除数符号相同

#### 整型/整型=整型

```c
int main (){
    double a = 5/2;
    printf("%f", a);
    return 0;
}
2.000000
```

#### 小类型转大类型 -- 自动类型转换

```c
int main (){
    double a = 1;
    printf("%f", a);
    return 0;
}
1.000000
```

#### ++

`a++`等价`a=a+1`

`a+=2`等价`a=a+2`

`a%=2`等价`a=a%5`

前置时在所有表达式运算前先执行

后置时在所有表达式运算后再执行

#### 逻辑运算符

| 运算符 |     表达式     |                    说明                    |
| :----: | :------------: | :----------------------------------------: |
| &&并且 |  条件1&条件2   |        两个条件同时为真时，结果为真        |
| \|\|或 | 条件1\|\|条件2 |      两个条件有一一个为真时，结果为真      |
|   !    |     !条件      | 条件为真时，结果为假；条件为假时，结果为真 |

“！=”代表“不等于”

“||或”为短路运算：当左边为“0假”时，左边将不被执行

#### 位运算符

| 运算符 |    作用    |                 示例                  |
| :----: | :--------: | :-----------------------------------: |
|   &    |   按位与   |       两个操作数同时为1结果为1        |
|   l    |   按位或   |  两个操作数只要有一个为1，结果就为1   |
|   ~    |   按位非   | 操作数为1，结果为0;操作数为0，结果为1 |
|   ^    |  按位异或  | 两个操作数相同，结果为0;不相同结果为1 |
|   <<   |    左移    |              右侧空位补0              |
|   >>   |    右移    |           左侧空位补符号位            |
|  >>>>  | 无符号右移 |              左侧空位补0              |

#### sizeof运算符

获得数据**类型**占用内存空间大小

#### 运算优先等级

- 单目运算符包括!~++ -- sizeof，优先级别高
- 优先级别最低的是赋值运算符
- 可以通过(控制表达式的运算顺序，()优先级最高
- 从右向左结合性的只有赋值运算符、三目运算符和单目运算符
- 算术运算符>关系运算符>逻辑运算符

### 位运算符

位运算符只作用于二进制数上

#### 1.按位与运算符（&）【69&115，65】

01000101

01110011

&——————

01000001

#### 2.按位或运算符（|）【69|115，119】

01000101

01110011

|——————

01110111

#### 3.按位异或运算符（^）[相同为0，不同为1]

#### 4.非运算符（~）

#### 5.位左移运算符（<<）

左侧丢失，右侧补0

#### 6.位右移运算符（>>）

右侧丢失，左侧1.无符号补0	2.有符号补符号位

### 函数

三要素：返回值类型，函数名，参数列表

```c
return_type function_name([datatype1 arg1],[datatype arg2],[…]){
    //函数体
}
```

#### 函数块

```c
int main(){
    int a=10;
    {
        int a=1l;
    }
    printf("%d",a) ;
}
//10
```

```c
int main(){
	int a-10;
    {
		a=1l;
	)
	printf("%d",a);
}
//11
```

```c
int main (){
    int a=10;
    {
        int a=ll;
    	a=12;
    }
    printf( "%d",a);
}
//10
```



### 文件操作

#### 1.

用一个**指针变量**指向一个文件，通过对文件指针操作，来对文件进行操作。

FILE *指针变量名;	例如：**FILE \*fp;**

FILE为系统的一个结构体

#### 2.

fopen()文件打开

**fp=fopen(****“****文件名****”****，****”****文件打开方式****”****);**	**//**文件名若为路径，路径需用//代替/

打开方式rt(打开失败返回NULL),wt（文件不存在则新建文件）,at（文件不存在返回NULL）,rb,wb,ab,+

fclose()文件关闭

**fclose(fp);**

#### 3.

fgetc();	读取一个字符//刚开始打开文件时，指向第1个字符，读取完成后，指针**自加**（无需自己操作），移动到下一个字符

**char ch;**

**FILE \*fp;**

**...**

**ch = fgetc(fp);**

#### 4.EOF文件结束标志（宏定义，其值为-1）

fputc(); 写入一个字符//

**fputc(字符,文件指针)；**

#### 5.

**fread(buffer,size,n,fp);**

从fp中读取n个数据项（size为数据块的字节数），存放到buffer指针，并返回读出的数据项个数（失败返回0）

**fwriter(buffer,size,n,fp);**

将buffer指向的n个数据，写入fp文件中（失败返回0）

### 关键词

#### switch

swith结构中，需要在最后加上“break”跳出结构,否则满足的条件执行后将继续执行下一条

```C
swtich(变量){
    case常量1:
        语句1;
        break;
    case常量2:
        语句2;
        break;
    case常量3:
        语句3;
        break;
    default:
        语句4;
        break;
}
```

#### if

```c
if(条件1)
{
    语句1;
}else if(条件2){
    语句2;
}else{
    语句3;
}
```

#### while

```c
while(条件){
    语句;
    i++;
}
```

#### do...while

```c
do{
	语句1;
    i++
}while(条件1);
```

#### for

```c
for(表达式1;表达式2;表达式3){
	语句;
}
/*
表达式1：赋初值
表达式2：循环条件
表达式3：循环变量的更新
三个表达式都可省略，但分号“;”不可省略！
顺序类似while循环
*/
```

#### continue

跳过本次循环，继续下次循环

![continue语句](res\continue.png)

#### define

```c
define N 50;		//即N=50 (N替换一段代码)
```

## 调试

添加断点：F5/单机行号

开始调试：F8/红色按钮

单步调试/下一行：F7

调试窗口——》监视

## 算法

### 冒泡排序

```c
int nums[ 5]={5,4,3,2，1};
int i,j,a;
for (i=0;i<4;i++){
    for(j=0;j<(4-i);j++){
            if(nums[j] >nums[j+1])
    a=nums[j];
    nums[j]=nums[j+1];
    nums[j+l]=a;
    }
}
printf("%d\t%d\t%d\td\t%d",nums[0],nums[1],nums[2],nums[3],nums[4]);
return 0;
```

外部循环控制比较轮数【N**-1**】[将最大的放到5个数中最后一位(从后开始确定)]

内部循环控制每轮比较次数【N-i-1】[排列前(5-i)个未知大小]

### 选择排序

```c
int a[ 5];
for(i=0;i<5; i++){
    scanf(" %d", &a[i]);
}
for(i=0;i<4;i++){
    for(j=i+l;j<5;j++){
        if(a[i]>a[j]){
            t=a[i];
            a[i]=a[j];
            a[j]=t;
        }
    }
}
```

外部循环选择比较数，比较轮数【N-1】[将最小的放到第一位（从头开始确定）]

内部循环选择比较对象,比较次数【N-i-1】

### 递归

递归：函数调用自己的过程

```c
int factorial(int num){
    if(num == 1)/退出条件
    	return 1;
    else{
        num = num*factorial(num- 1);
    	return num;
    }  
}
```

```c
#include <stdio.h>
int main(
	//计算5的阶乘
	int result = factorial(5);
}
```

注意点：

1. 有有反复的执行过程（调用自身）
2. 有跳出反复执行过程的条件（出口)

### 删除

如：**12  23  13  24  8**

1）查找要删除的数字的下标：如13（下标2）

2）从下标开始，后面一个覆盖前面一个数字

如：**12  23  24  8   8**

3）数组的总长度减1(打印时少打一个)

```c
int n=3;
int nums[]={2,5,3};
/******/
for (i=0;i<n-1;i++){
  printf("%d",nums[i]);
}
```

## 其他

### 表达区间

如：1<a<3

写为：`a>1 && a<3`

### 无限循环

`for(;;)`

`while(1)`

### ==与=

`== `恒等

`= `赋值

### 乘号

`2*a`不要写成 “2a”

### 播放音乐

```c
#include <windows.h>
#include <mmsystem.h>
#pragma comment (lib，"Winmm.lib" )
//播放音乐
Playsound( TEXT( "sounds\l背景音乐.wav" ),
	NULL,SND_FILENAME | SND_ASYNC | sND_LOOP);
```

### 命令框

颜色属性由两个十六进制数字指定，第一个为背景色，第二个为前景色。
每个数字可以为下列值之一:
黑色=0	蓝色= 1	绿色= 2	湖蓝色=3
紫色= 5	黄色= 6	红色=4	白色=7
灰色= 8	淡蓝色=9	淡绿色=A	淡红色=C
淡紫色=D	淡黄色=E	亮白色=F
`Sysetem("color 4E");`

### 定时关机

`System(“shutdown /r /t180”);`
`Systmen(“shutdown /a”);`

